<!--pages/management/team_events/team_events.wxml-->
<view class="page-container">
  <!-- 顶部球队选择卡片 -->
  <view class="team-card" wx:if="{{teamList.length > 0}}">
    <picker mode="selector" range="{{teamList}}" range-key="name" value="{{selectedTeamIndex}}" bindchange="onTeamChange">
      <view class="team-card-content">
        <image class="team-avatar" src="{{selectedTeam.logoUrl || '/assets/team.png'}}" mode="aspectFill" />
        <view class="team-info">
          <text class="team-name">{{selectedTeam.name}}</text>
          <text class="team-hint">点击切换球队</text>
        </view>
        <image class="switch-icon" src="/assets/down333.png" mode="aspectFit" />
      </view>
    </picker>
  </view>

  <!-- 赛事列表标题 -->
  <view class="section-header" wx:if="{{!isLoading && teamList.length > 0}}">
    <text class="section-title">参与的赛事</text>
    <text class="event-count">共 {{eventList.length}} 项</text>
  </view>

  <!-- 赛事卡片列表 -->
  <view class="event-card-list" wx:if="{{!isLoading && eventList.length > 0}}">
    <view wx:for="{{eventList}}" wx:key="eventId" class="event-card" bindtap="gotoRosterPage" data-event="{{item}}">
      <!-- 赛事头部 -->
      <view class="event-card-header">
        <view class="event-title-row">
          <image class="event-trophy" src="/assets/cup.svg" mode="aspectFit" />
          <text class="event-title">{{item.name}}</text>
        </view>
        <view class="roster-badge {{item.hasRoster ? 'set' : 'unset'}}">
          {{item.hasRoster ? '已设置' : '未设置'}}
        </view>
      </view>
      
      <!-- 赛事信息 -->
      <view class="event-card-body">
        <view class="info-grid">
          <view class="info-item">
            <text class="info-label">赛制</text>
            <text class="info-value">{{item.matchPlayerCount || 11}}人制</text>
          </view>
          <view class="info-item">
            <text class="info-label">大名单上限</text>
            <text class="info-value">{{item.rosterSize || 23}}人</text>
          </view>
          <view class="info-item">
            <text class="info-label">已选人数</text>
            <text class="info-value highlight">{{item.rosterCount || 0}}人</text>
          </view>
          <view class="info-item">
            <text class="info-label">截止日期</text>
            <text class="info-value {{item.isExpired ? 'expired' : ''}}">{{item.deadlineStr || '未设置'}}</text>
          </view>
        </view>
      </view>
      
      <!-- 赛事底部 -->
      <view class="event-card-footer">
        <view class="deadline-status" wx:if="{{item.rosterDeadline}}">
          <text class="status-text {{item.isExpired ? 'expired' : 'active'}}">
            {{item.isExpired ? '已截止，仅可查看' : '可编辑大名单'}}
          </text>
        </view>
        <view class="action-hint">
          <text>{{item.isExpired ? '查看名单' : '设置名单'}}</text>
          <text class="arrow-text">›</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{!isLoading && eventList.length === 0 && teamList.length > 0}}">
    <image class="empty-icon" src="/assets/cup.svg" mode="aspectFit" />
    <text class="empty-text">该球队暂未参与任何赛事</text>
    <text class="empty-hint">赛事管理员邀请球队后会显示在此处</text>
  </view>

  <!-- 无球队提示 -->
  <view class="empty-state" wx:if="{{teamList.length === 0 && !isLoading}}">
    <image class="empty-icon" src="/assets/team.png" mode="aspectFit" />
    <text class="empty-text">您还没有管理的球队</text>
    <text class="empty-hint">创建或加入球队后可在此管理大名单</text>
  </view>

  <!-- 加载中 -->
  <view class="loading-state" wx:if="{{isLoading}}">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>
</view>
